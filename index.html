<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ForgeAIHub ‚Äî AI Tools (TTS, TTI & Chat)</title>

<style>
  :root{
    --accent:#0066ff;
    --accent-dark:#004bd1;
    --bg:#f3f7ff;
    --card:#ffffff;
    --radius:16px;
    --cancel:#eef3ff;
  }

  body{
    font-family:Inter,system-ui,-apple-system,"Poppins",sans-serif;
    margin:0;
    background:linear-gradient(135deg,#e7f1ff,#f8fbff);
    color:#1a1a1a;
    padding:20px;
  }

  .wrap{max-width:1100px;margin:0 auto}

  header{
    padding:8px 0;
    margin-bottom:24px;
    text-align:center;
  }
  header h1{margin:0;font-size:1.9rem;font-weight:800;color:#0054e6;}
  header p{margin:4px 0 0;color:#4e5d78;font-size:1rem;}

  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:20px;
  }
  @media(max-width:920px){ .grid{grid-template-columns:1fr} }

  .card{
    background:var(--card);
    padding:20px;
    border-radius:var(--radius);
    box-shadow:0 8px 30px rgba(0,0,0,0.06);
  }

  label{font-weight:600;margin-bottom:6px;display:block;font-size:0.95rem;}
  textarea,input,select{width:100%;padding:12px;border-radius:10px;border:1px solid #d9e3f3;font-size:1rem;background:#f9fbff;}

  .btn{
    background:var(--accent);
    color:white;
    padding:10px 16px;
    border:none;
    font-weight:600;
    border-radius:10px;
    cursor:pointer;
    transition:0.2s;
  }
  .btn:hover{background:var(--accent-dark)}
  .btn.secondary{background:#eef3ff;color:#222;}
  .btn.red{background:#eef3ff;color:#222;}

  .controls{display:flex;gap:10px;align-items:center;margin-top:12px;}
  .loader{width:28px;height:28px;border-radius:50%;border:4px solid #e5e9f5;border-top-color:var(--accent);animation:spin 1s linear infinite;}
  @keyframes spin{to{transform:rotate(360deg)}}

  .out{margin-top:12px}

  .chat-area{
    height:320px;
    overflow-y:auto;
    border:1px solid #e1e8f5;
    border-radius:var(--radius);
    background:#fafcff;
    padding:12px;
  }

  .msg{
    padding:10px 12px;
    border-radius:12px;
    margin:8px 0;
    max-width:85%;
    line-height:1.4;
  }
  .msg.user{background:#e3f0ff;margin-left:auto;}
  .msg.bot{background:#eef2f7;}

  .chat-input-wrap{position:relative;display:flex;align-items:center;}
  #chatInput{flex:1;padding-right:36px;border-radius:10px;border:1px solid #d9e3f3;}
  #clearChatInput{
    position:absolute;
    right:10px;
    background:var(--cancel);
    border:none;
    border-radius:50%;
    width:24px;
    height:24px;
    text-align:center;
    cursor:pointer;
    font-weight:bold;
    display:none;
  }

  footer{margin-top:26px;text-align:center;padding:10px 0;color:#667;font-size:0.9rem;}
</style>
</head>

<body>
<div class="wrap">

  <header>
    <h1>ForgeAIHub</h1>
    <p>Your free AI Toolkit ‚Äî Text-to-Speech, Text-to-Image and AI Chat</p>
  </header>

  <div class="grid">

    <!-- TTS -->
    <section class="card">
      <h3>üîä Text to Speech (TTS)</h3>

      <label for="ttsText">Text</label>
      <textarea id="ttsText" rows="5">Welcome to ForgeAIHub!</textarea>

      <label>Voice</label>
      <select id="voiceSelect">
        <option>Joanna</option>
        <option>Matthew</option>
        <option>Kimberly</option>
        <option>Justin</option>
        <option>Salli</option>
      </select>

      <label>Speed</label>
      <select id="speed">
        <option value="0.8">Slow</option>
        <option value="1" selected>Normal</option>
        <option value="1.25">Fast</option>
      </select>

      <div class="controls">
        <button id="genTtsBtn" class="btn">Generate</button>
        <button id="stopTtsBtn" class="btn secondary">Stop</button>
        <button id="clearTtsBtn" class="btn red">Clear</button>
        <div id="ttsSpinner" style="display:none"><div class="loader"></div></div>
      </div>

      <div id="ttsOut" class="out"></div>
    </section>

    <!-- TTI -->
    <section class="card">
      <h3>üñºÔ∏è Text to Image (TTI)</h3>

      <label for="imgPrompt">Prompt</label>
      <textarea id="imgPrompt" rows="4">A flat-lay of coffee and notebook, soft light.</textarea>

      <label>Style</label>
      <select id="styleSel">
        <option value="photorealistic">Photorealistic</option>
        <option value="digital-painting">Digital Painting</option>
        <option value="vector">Vector / Flat</option>
      </select>

      <label>Size</label>
      <select id="sizeSel">
        <option value="512">512√ó512</option>
        <option value="768">768√ó768</option>
        <option value="1024">1024√ó1024</option>
      </select>

      <div class="controls">
        <button id="genImgBtn" class="btn">Generate Image</button>
        <button id="clearImgBtn" class="btn secondary">Clear</button>
        <div id="imgSpinner" style="display:none"><div class="loader"></div></div>
      </div>

      <div id="imgOut" class="out"></div>
    </section>
  </div>

  <!-- Chat Section -->
  <div class="card" style="margin-top:22px">
    <h3>üí¨ AI Chat Assistant</h3>

    <div id="chatArea" class="chat-area"></div>

    <div class="chat-input-wrap" style="margin-top:10px">
      <input id="chatInput" placeholder="Type your message here..." />
      <button id="clearChatInput">√ó</button>
    </div>

    <div class="controls">
      <button id="sendChatBtn" class="btn">Send</button>
      <button id="clearChatBtn" class="btn red">Clear Chat</button>
    </div>
  </div>

  <footer>¬© ForgeAIHub 2025 ‚Äî AI Tools for Everyone</footer>

</div>

<script>
const BACKEND_URL = "https://forgeaihub-5.onrender.com"; 

/* Helpers */
const show = (el, ok=true)=> el.style.display = ok ? '' : 'none';
const blobToUrl = b => URL.createObjectURL(b);

/* ===== TTS ===== */
let activeAudio = null;
const ttsOut = document.getElementById('ttsOut');
const ttsSpinner = document.getElementById('ttsSpinner');

document.getElementById('genTtsBtn').onclick = async () => {
  const text = document.getElementById('ttsText').value.trim();
  if (!text) return alert("Enter text");
  ttsOut.innerHTML = "";
  show(ttsSpinner, true);

  try {
    const r = await fetch(`${BACKEND_URL}/tts`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ text })
    });
    if (!r.ok) { 
      ttsOut.innerHTML = "<div style='color:red'>Failed to generate audio.</div>"; 
      return; 
    }
    const blob = await r.blob();
    const url = blobToUrl(blob);

    const audio = document.createElement("audio");
    audio.controls = true;
    audio.src = url;
    audio.autoplay = true;
    activeAudio = audio;
    ttsOut.appendChild(audio);
  } catch (e) {
    ttsOut.innerHTML = "Network Error";
  }
  show(ttsSpinner, false);
};

document.getElementById('stopTtsBtn').onclick = () => {
  if (activeAudio) { activeAudio.pause(); activeAudio.currentTime = 0; }
};
document.getElementById('clearTtsBtn').onclick = () => {
  document.getElementById('ttsText').value = "";
  ttsOut.innerHTML = "";
};

/* ===== TTI ===== */
const imgOut = document.getElementById('imgOut');
const imgSpinner = document.getElementById('imgSpinner');

document.getElementById('genImgBtn').onclick = async () => {
  const prompt = document.getElementById('imgPrompt').value.trim();
  if (!prompt) return alert("Enter a prompt");
  imgOut.innerHTML = "";
  show(imgSpinner, true);

  try {
    const r = await fetch(`${BACKEND_URL}/tti`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({
        prompt,
        style: document.getElementById('styleSel').value,
        size: document.getElementById('sizeSel').value
      })
    });
    if (!r.ok) { 
      imgOut.innerHTML = "<div style='color:red'>Generation failed.</div>"; 
      return; 
    }
    const blob = await r.blob();
    const url = blobToUrl(blob);
    const img = document.createElement("img");
    img.src = url;
    img.style.width = "100%";
    img.style.borderRadius = "12px";
    imgOut.appendChild(img);
  } catch (e) {
    imgOut.innerHTML = "Network Error";
  }
  show(imgSpinner, false);
};

document.getElementById('clearImgBtn').onclick = () => {
  document.getElementById('imgPrompt').value = "";
  imgOut.innerHTML = "";
};

/* ===== CHAT ===== */
const chatArea = document.getElementById('chatArea');

function addMsg(t, w) {
  const d = document.createElement('div');
  d.className = "msg " + w;
  d.textContent = t;
  chatArea.appendChild(d);
  chatArea.scrollTop = chatArea.scrollHeight;
}

const chatInput = document.getElementById('chatInput');
const clearChatInput = document.getElementById('clearChatInput');

chatInput.addEventListener('input', () => {
  clearChatInput.style.display = chatInput.value ? 'block' : 'none';
});
clearChatInput.addEventListener('click', () => {
  chatInput.value = "";
  clearChatInput.style.display = 'none';
});

document.getElementById('sendChatBtn').onclick = async () => {
  const text = chatInput.value.trim();
  if (!text) return;
  addMsg(text, "user");
  chatInput.value = "";
  clearChatInput.style.display = 'none';

  const loading = document.createElement("div");
  loading.className = "msg bot";
  loading.textContent = "...";
  chatArea.appendChild(loading);
  chatArea.scrollTop = chatArea.scrollHeight;

  try {
    const r = await fetch(`${BACKEND_URL}/chat`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ message: text })
    });
    const j = await r.json();
    loading.remove();
    addMsg(j.response || "No reply", "bot"); // ‚úÖ FIXED key
  } catch (e) {
    loading.textContent = "Network error";
  }
};

document.getElementById('clearChatBtn').onclick = () => {
  chatArea.innerHTML = "";
};
</script>
</body>
</html>